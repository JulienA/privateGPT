version: "3.9"
services:
  privategpt-ingest:
    build: .
    image: privategpt:test
    command: [ "python", "src/ingest.py" ]
    environment:
      - PERSIST_DIRECTORY=${PERSIST_DIRECTORY:-/home/privategpt/db}
      - LLAMA_EMBEDDINGS_MODEL=${LLAMA_EMBEDDINGS_MODEL:-/home/privategpt/models/ggml-model-q4_0.bin}
      - MODEL_TYPE=${MODEL_TYPE:-GPT4All}
      - MODEL_PATH=${MODEL_PATH:-/home/privategpt/models/ggml-gpt4all-j-v1.3-groovy.bin}
      - MODEL_N_CTX=${MODEL_N_CTX:-1000}
      - SOURCE_DIRECTORY=${SOURCE_DIRECTORY:-/home/privategpt/source_documents}
    volumes:
      - ${MODEL_MOUNT:-./models}:/home/privategpt/models
      - ${PERSIST_MOUNT:-./db}:/home/privategpt/db
      - ${SOURCE_MOUNT:-./source_documents}:/home/privategpt/source_documents
